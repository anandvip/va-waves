<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meditative Wave Flow</title>
    <style>
        :root {
            --glow-intensity: 2;
            --wave-amplitude: 50;
            --wave-frequency: 0.02;
            --ripple-speed: 2;
            --primary-hue: 45;
            --secondary-hue: 200;
            --layer-opacity: 0.8;
            --ambient-glow: 1;
            --wave-distortion: 1;
            --line-thickness: 1;
            --ui-opacity: 0.95;
            --wave-orientation: 'vertical';
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            height: 100vh;
            overflow: hidden;
            background: radial-gradient(ellipse at center, 
                hsl(var(--secondary-hue), 40%, 8%) 0%,
                hsl(var(--secondary-hue), 60%, 4%) 50%,
                hsl(var(--secondary-hue), 80%, 2%) 100%);
            position: relative;
            touch-action: none;
        }

        .wave-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            pointer-events: none;
            z-index: 1;
        }

        .wave-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .gear-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: rgba(0, 10, 20, var(--ui-opacity));
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 1001;
            transition: all 0.3s ease;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .gear-toggle:hover {
            transform: rotate(90deg) scale(1.1);
            box-shadow: 0 6px 25px rgba(255, 255, 255, 0.1);
        }

        .gear-icon {
            width: 24px;
            height: 24px;
            fill: hsl(45, 100%, 75%);
            transition: all 0.3s ease;
        }

        .controls-panel {
            position: fixed;
            top: 20px;
            right: 80px;
            background: rgba(0, 10, 20, var(--ui-opacity));
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            color: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-width: 300px;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            z-index: 1000;
            pointer-events: auto;
            transform: translateX(0);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .controls-panel.hidden {
            transform: translateX(calc(100% + 20px));
            pointer-events: none;
        }

        .info-toggle {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 40px;
            height: 40px;
            background: rgba(0, 10, 20, var(--ui-opacity));
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 1001;
            transition: all 0.3s ease;
            font-size: 18px;
            color: hsl(45, 100%, 75%);
        }

        .info-toggle:hover {
            transform: scale(1.1);
            background: rgba(0, 10, 20, 1);
        }

        .info-panel {
            position: fixed;
            bottom: 20px;
            left: 70px;
            background: rgba(0, 10, 20, var(--ui-opacity));
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            color: rgba(255, 255, 255, 0.9);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 11px;
            max-width: 280px;
            z-index: 1000;
            pointer-events: auto;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .info-panel.hidden {
            transform: translateX(calc(-100% - 50px));
            pointer-events: none;
        }

        .info-panel strong {
            color: hsl(45, 100%, 85%);
        }

        .control-group {
            margin-bottom: 20px;
        }

        .control-group h3 {
            color: hsl(45, 100%, 85%);
            margin-bottom: 12px;
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 5px;
        }

        .control-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            font-size: 12px;
        }

        .control-item label {
            color: rgba(255, 255, 255, 0.9);
            flex: 1;
            font-weight: 500;
        }

        .control-item input[type="range"] {
            flex: 1.5;
            margin-left: 15px;
            accent-color: hsl(45, 100%, 70%);
        }

        .control-item select {
            flex: 1.5;
            margin-left: 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            color: white;
            padding: 4px 8px;
            font-size: 11px;
        }

        .control-item .value-display {
            min-width: 40px;
            text-align: right;
            color: hsl(45, 100%, 75%);
            font-size: 11px;
            margin-left: 8px;
        }

        .preset-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }

        .preset-btn {
            background: linear-gradient(135deg, 
                hsla(var(--primary-hue), 70%, 50%, 0.8),
                hsla(var(--primary-hue), 80%, 40%, 0.9));
            border: none;
            color: white;
            padding: 10px 14px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 11px;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.3px;
            font-weight: 600;
        }

        .preset-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px hsla(var(--primary-hue), 70%, 50%, 0.4);
        }

        .meditation-mode {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 10, 20, 0.7);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            color: rgba(255, 255, 255, 0.8);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            text-align: center;
            z-index: 999;
            opacity: 0;
            pointer-events: none;
            transition: all 0.5s ease;
        }

        .meditation-mode.active {
            opacity: 1;
            pointer-events: auto;
        }

        /* Mobile optimizations */
        @media (max-width: 768px) {
            .controls-panel {
                right: 10px;
                top: 70px;
                min-width: calc(100vw - 40px);
                max-width: calc(100vw - 40px);
                max-height: 60vh;
            }

            .gear-toggle {
                top: 10px;
                right: 10px;
                width: 45px;
                height: 45px;
            }

            .info-panel {
                bottom: 10px;
                left: 60px;
                max-width: calc(100vw - 90px);
                font-size: 10px;
            }

            .info-toggle {
                bottom: 10px;
                left: 10px;
                width: 35px;
                height: 35px;
                font-size: 16px;
            }
        }

        /* Scrollbar styling */
        .controls-panel::-webkit-scrollbar {
            width: 6px;
        }

        .controls-panel::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
        }

        .controls-panel::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <div class="wave-container">
        <canvas class="wave-canvas" id="waveCanvas"></canvas>
    </div>
    
    <!-- Gear Toggle Button -->
    <div class="gear-toggle" id="gearToggle">
        <svg class="gear-icon" viewBox="0 0 24 24">
            <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.22,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.22,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.68 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"/>
        </svg>
    </div>

    <!-- Info Toggle Button -->
    <div class="info-toggle" id="infoToggle">ℹ</div>
    
    <!-- Controls Panel -->
    <div class="controls-panel" id="controlsPanel">
        <div class="control-group">
            <h3>Interface</h3>
            <div class="control-item">
                <label>UI Opacity</label>
                <input type="range" id="uiOpacity" min="0.1" max="1" step="0.05" value="0.95">
                <span class="value-display" id="uiOpacityValue">0.95</span>
            </div>
            <div class="control-item">
                <label>Wave Direction</label>
                <select id="waveOrientation">
                    <option value="vertical">Vertical (↓)</option>
                    <option value="horizontal">Horizontal (←)</option>
                </select>
            </div>
        </div>

        <div class="control-group">
            <h3>Oscilloscope Effects</h3>
            <div class="control-item">
                <label>Wave Amplitude</label>
                <input type="range" id="waveAmplitude" min="10" max="150" step="5" value="50">
                <span class="value-display" id="amplitudeValue">50</span>
            </div>
            <div class="control-item">
                <label>Wave Frequency</label>
                <input type="range" id="waveFrequency" min="0.005" max="0.05" step="0.001" value="0.02">
                <span class="value-display" id="frequencyValue">0.02</span>
            </div>
            <div class="control-item">
                <label>Wave Distortion</label>
                <input type="range" id="waveDistortion" min="0.5" max="3" step="0.1" value="1">
                <span class="value-display" id="distortionValue">1.0</span>
            </div>
            <div class="control-item">
                <label>Line Thickness</label>
                <input type="range" id="lineThickness" min="0.5" max="4" step="0.1" value="1">
                <span class="value-display" id="thicknessValue">1.0</span>
            </div>
        </div>

        <div class="control-group">
            <h3>Meditation Flow</h3>
            <div class="control-item">
                <label>Flow Speed</label>
                <input type="range" id="rippleSpeed" min="0.5" max="5" step="0.1" value="2">
                <span class="value-display" id="speedValue">2.0</span>
            </div>
            <div class="control-item">
                <label>Glow Intensity</label>
                <input type="range" id="glowIntensity" min="0.5" max="5" step="0.1" value="2">
                <span class="value-display" id="glowValue">2.0</span>
            </div>
            <div class="control-item">
                <label>Layer Opacity</label>
                <input type="range" id="layerOpacity" min="0.3" max="1" step="0.05" value="0.8">
                <span class="value-display" id="opacityValue">0.8</span>
            </div>
        </div>

        <div class="control-group">
            <h3>Color Therapy</h3>
            <div class="control-item">
                <label>Primary Hue</label>
                <input type="range" id="primaryHue" min="0" max="360" step="1" value="45">
                <span class="value-display" id="primaryValue">45°</span>
            </div>
            <div class="control-item">
                <label>Secondary Hue</label>
                <input type="range" id="secondaryHue" min="0" max="360" step="1" value="200">
                <span class="value-display" id="secondaryValue">200°</span>
            </div>
        </div>

        <div class="control-group">
            <h3>Meditation Presets</h3>
            <div class="preset-buttons">
                <button class="preset-btn" onclick="applyPreset('breathe')">Deep Breath</button>
                <button class="preset-btn" onclick="applyPreset('calm')">Ocean Calm</button>
                <button class="preset-btn" onclick="applyPreset('focus')">Mind Focus</button>
                <button class="preset-btn" onclick="applyPreset('energy')">Energy Flow</button>
            </div>
        </div>
    </div>

    <!-- Info Panel -->
    <div class="info-panel" id="infoPanel">
        <strong>Meditative Wave Flow</strong><br>
        Perfect for meditation and breath focus.<br>
        Watch the waves and sync your breathing rhythm.<br>
        <em>Tap gear icon to hide controls for pure meditation.</em>
    </div>

    <script>
        class MeditativeWaves {
            constructor() {
                this.canvas = document.getElementById('waveCanvas');
                this.ctx = this.canvas.getContext('2d');
                this.time = 0;
                this.waves = [];
                this.numberOfWaves = 15;
                this.orientation = 'vertical';
                
                this.setupCanvas();
                this.setupControls();
                this.setupToggleButtons();
                this.generateWaves();
                this.animate();
            }

            setupCanvas() {
                const resize = () => {
                    this.canvas.width = window.innerWidth;
                    this.canvas.height = window.innerHeight;
                    this.generateWaves(); // Regenerate on resize
                };
                resize();
                window.addEventListener('resize', resize);
            }

            setupToggleButtons() {
                // Gear toggle for controls panel
                const gearToggle = document.getElementById('gearToggle');
                const controlsPanel = document.getElementById('controlsPanel');
                
                gearToggle.addEventListener('click', () => {
                    controlsPanel.classList.toggle('hidden');
                });

                // Info toggle for info panel
                const infoToggle = document.getElementById('infoToggle');
                const infoPanel = document.getElementById('infoPanel');
                
                infoToggle.addEventListener('click', () => {
                    infoPanel.classList.toggle('hidden');
                });

                // Touch-friendly tap handling
                gearToggle.addEventListener('touchend', (e) => {
                    e.preventDefault();
                    controlsPanel.classList.toggle('hidden');
                });

                infoToggle.addEventListener('touchend', (e) => {
                    e.preventDefault();
                    infoPanel.classList.toggle('hidden');
                });
            }

            setupControls() {
                const controls = {
                    uiOpacity: (value) => {
                        document.documentElement.style.setProperty('--ui-opacity', value);
                        document.getElementById('uiOpacityValue').textContent = parseFloat(value).toFixed(2);
                    },
                    waveOrientation: (value) => {
                        this.orientation = value;
                        this.generateWaves();
                    },
                    waveAmplitude: (value) => {
                        document.documentElement.style.setProperty('--wave-amplitude', value);
                        document.getElementById('amplitudeValue').textContent = value;
                    },
                    waveFrequency: (value) => {
                        document.documentElement.style.setProperty('--wave-frequency', value);
                        document.getElementById('frequencyValue').textContent = parseFloat(value).toFixed(3);
                    },
                    waveDistortion: (value) => {
                        document.documentElement.style.setProperty('--wave-distortion', value);
                        document.getElementById('distortionValue').textContent = parseFloat(value).toFixed(1);
                    },
                    lineThickness: (value) => {
                        document.documentElement.style.setProperty('--line-thickness', value);
                        document.getElementById('thicknessValue').textContent = parseFloat(value).toFixed(1);
                    },
                    rippleSpeed: (value) => {
                        document.documentElement.style.setProperty('--ripple-speed', value);
                        document.getElementById('speedValue').textContent = parseFloat(value).toFixed(1);
                    },
                    glowIntensity: (value) => {
                        document.documentElement.style.setProperty('--glow-intensity', value);
                        document.getElementById('glowValue').textContent = parseFloat(value).toFixed(1);
                    },
                    layerOpacity: (value) => {
                        document.documentElement.style.setProperty('--layer-opacity', value);
                        document.getElementById('opacityValue').textContent = parseFloat(value).toFixed(2);
                    },
                    primaryHue: (value) => {
                        document.documentElement.style.setProperty('--primary-hue', value);
                        document.getElementById('primaryValue').textContent = value + '°';
                    },
                    secondaryHue: (value) => {
                        document.documentElement.style.setProperty('--secondary-hue', value);
                        document.getElementById('secondaryValue').textContent = value + '°';
                    }
                };

                Object.entries(controls).forEach(([id, callback]) => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.addEventListener('input', (e) => callback(e.target.value));
                        element.addEventListener('change', (e) => callback(e.target.value));
                        // Initialize display values
                        callback(element.value);
                    }
                });
            }

            generateWaves() {
                this.waves = [];
                for (let i = 0; i < this.numberOfWaves; i++) {
                    if (this.orientation === 'vertical') {
                        this.waves.push({
                            position: (i / this.numberOfWaves) * this.canvas.height,
                            offset: i * 0.5,
                            opacity: 0.9 - (i * 0.04),
                            phase: Math.random() * Math.PI * 2,
                            speed: 1 + (i * 0.1),
                            isVertical: true
                        });
                    } else {
                        this.waves.push({
                            position: (i / this.numberOfWaves) * this.canvas.width,
                            offset: i * 0.5,
                            opacity: 0.9 - (i * 0.04),
                            phase: Math.random() * Math.PI * 2,
                            speed: 1 + (i * 0.1),
                            isVertical: false
                        });
                    }
                }
            }

            drawWave(wave) {
                const amplitude = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--wave-amplitude'));
                const frequency = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--wave-frequency'));
                const distortion = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--wave-distortion'));
                const thickness = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--line-thickness'));
                const rippleSpeed = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--ripple-speed'));
                const glowIntensity = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--glow-intensity'));
                const primaryHue = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--primary-hue'));

                this.ctx.save();
                
                // Set up glow effect
                this.ctx.shadowColor = `hsl(${primaryHue}, 100%, 70%)`;
                this.ctx.shadowBlur = glowIntensity * 8;
                this.ctx.globalAlpha = wave.opacity;
                this.ctx.lineWidth = thickness;
                this.ctx.strokeStyle = `hsl(${primaryHue}, 90%, 75%)`;

                this.ctx.beginPath();
                
                if (wave.isVertical) {
                    // Vertical waves (top to bottom ripple)
                    const rippleOffset = Math.sin(this.time * rippleSpeed + wave.offset) * 30;
                    const currentY = wave.position + rippleOffset;
                    
                    if (currentY < -50 || currentY > this.canvas.height + 50) {
                        this.ctx.restore();
                        return;
                    }

                    const step = 2;
                    for (let x = 0; x <= this.canvas.width; x += step) {
                        const baseWave = Math.sin(x * frequency + this.time + wave.phase);
                        const harmonics = Math.sin(x * frequency * 2 + this.time * 1.5) * 0.3;
                        const distortionWave = Math.sin(x * frequency * 0.5 + this.time * 0.7) * distortion;
                        
                        const y = currentY + (baseWave + harmonics + distortionWave) * amplitude * wave.speed;
                        
                        if (x === 0) {
                            this.ctx.moveTo(x, y);
                        } else {
                            this.ctx.lineTo(x, y);
                        }
                    }
                } else {
                    // Horizontal waves (left to right ripple)
                    const rippleOffset = Math.sin(this.time * rippleSpeed + wave.offset) * 30;
                    const currentX = wave.position + rippleOffset;
                    
                    if (currentX < -50 || currentX > this.canvas.width + 50) {
                        this.ctx.restore();
                        return;
                    }

                    const step = 2;
                    for (let y = 0; y <= this.canvas.height; y += step) {
                        const baseWave = Math.sin(y * frequency + this.time + wave.phase);
                        const harmonics = Math.sin(y * frequency * 2 + this.time * 1.5) * 0.3;
                        const distortionWave = Math.sin(y * frequency * 0.5 + this.time * 0.7) * distortion;
                        
                        const x = currentX + (baseWave + harmonics + distortionWave) * amplitude * wave.speed;
                        
                        if (y === 0) {
                            this.ctx.moveTo(x, y);
                        } else {
                            this.ctx.lineTo(x, y);
                        }
                    }
                }
                
                this.ctx.stroke();
                this.ctx.restore();
            }

            animate() {
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                
                this.waves.forEach(wave => {
                    this.drawWave(wave);
                });
                
                this.time += 0.02;
                requestAnimationFrame(() => this.animate());
            }
        }

        function applyPreset(preset) {
            const presets = {
                breathe: {
                    waveAmplitude: 30,
                    waveFrequency: 0.015,
                    waveDistortion: 0.5,
                    lineThickness: 1.5,
                    rippleSpeed: 1.2,
                    glowIntensity: 2.5,
                    layerOpacity: 0.7,
                    primaryHue: 180,
                    secondaryHue: 240
                },
                calm: {
                    waveAmplitude: 40,
                    waveFrequency: 0.01,
                    waveDistortion: 0.8,
                    lineThickness: 1,
                    rippleSpeed: 0.8,
                    glowIntensity: 1.5,
                    layerOpacity: 0.6,
                    primaryHue: 200,
                    secondaryHue: 220
                },
                focus: {
                    waveAmplitude: 60,
                    waveFrequency: 0.025,
                    waveDistortion: 1.2,
                    lineThickness: 2,
                    rippleSpeed: 1.8,
                    glowIntensity: 3,
                    layerOpacity: 0.8,
                    primaryHue: 45,
                    secondaryHue: 180
                },
                energy: {
                    waveAmplitude: 80,
                    waveFrequency: 0.03,
                    waveDistortion: 2,
                    lineThickness: 1.5,
                    rippleSpeed: 2.5,
                    glowIntensity: 4,
                    layerOpacity: 0.9,
                    primaryHue: 320,
                    secondaryHue: 120
                }
            };

            const config = presets[preset];
            if (config) {
                Object.entries(config).forEach(([key, value]) => {
                    const element = document.getElementById(key);
                    if (element) {
                        element.value = value;
                        element.dispatchEvent(new Event('input'));
                    }
                });
            }
        }

        // Initialize the meditative wave system
        document.addEventListener('DOMContentLoaded', () => {
            new MeditativeWaves();
        });
    </script>
</body>
</html>
